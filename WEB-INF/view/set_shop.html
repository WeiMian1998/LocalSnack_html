<!DOCTYPE html>
<html>
<head>
	<title>创建商户</title>
	<meta charset="utf-8" />
	<link rel="stylesheet" type="text/css" href="../../static/css/base.css">
	<link rel="stylesheet" type="text/css" href="../../static/css/index.css">
	<link rel="stylesheet" type="text/css" href="../../static/css/set_shop.css">
	<script src="../../static/js/jquery-1.9.0.min.js"></script>
	<script src="https://cdn.bootcss.com/vue/2.4.2/vue.min.js"></script>
	<script type="text/javascript" src="../../static/js/baseUrl.js" ></script>
</head>
<body>
	<div class="header-container">
		<div class="top-nav">
			<div class="top-nav-container clearfix">
				<div class="group mini-logo">
					<a target="_blank" class="item" href="index.html">当地小食</a>
				</div>
				<div class="group quick-menu">
					<span>
						<a id="username" target="_blank" class="item left-split username J-user-trigger undline" href="personal_sc.html">Admin</a>
						<span class="seprate">|</span>
					</span>
					<a target="_blank" class="item left-split user-msg J-message-trigger undline" href="#">我的预约</a>
					<span class="seprate">|</span>
					<a class="item J-my-center-trigger undline" href="personal_collection.html">个人中心</a>
					<span class="seprate">|</span>
					<a id="MyShop"style="display: none;" class="item J-my-center-trigger undline" href="MyShopping.html">我的商户</a>
					<span id="MyShop_span" style="display: none;" class="seprate">|</span>
					<a id="setShop"style="display: none;" class="item J-my-center-trigger undline" href="set_shop.html">创建商户</a>
					<span id="setShop_span" style="display: none;" class="seprate">|</span>
					<p onclick="logout()"  class="item left-split user-msg J-message-trigger undline">登出</p>

				</div>
			</div>
		</div>
	</div>

	<div class="main">
		<div class="main_title">
			<a class="back" href="index.html"><&nbsp;返回</a>
			<h5>添加商户</h5>
		</div>
		<div class="main_content">
			<form class="content_form">
				<div class="ant_row">
					<div class="c_text">
						<label class="c_title">添加商户</label>
					</div>
					<div class="c_input">
						<input id="shopName" class="ant_input" type="text" name="shopName" placeholder="请输入商户名称">
					</div>
				</div>
				
				<div id="cuisine" class="ant_row">
					<div class="c_text">
						<label class="c_title">菜系</label>
					</div>
					<div style="width: 500px;">
						<div style="width: 80px;float: left;"  v-for="data in datas">
							<input type="checkbox" name="caixi" v-bind:value="data.id"/>
							<label>{{data.name}}</label>
						</div>
					</div>
				</div>
				
				<div id="air" class="ant_row">
					<div class="c_text">
						<label class="c_title">氛围</label>
					</div>
					<div style="width: 500px;">
						<div style="width: 80px;float: left;"  v-for="data in datas">
							<input type="checkbox" name="fenwei" v-bind:value="data.id" />
							<label>{{data.name}}</label>
						</div>
					</div>
				</div>
				
				<div class="ant_row">
					<div class="c_text">
						<label class="c_title">所在地区</label>
					</div>
					<div class="parent">
						<!--所在地区-->
				      <select id="area">
				          <option>请选择</option>
				          <option id="area_op" v-for="data in datas" v-bind:value="data.id" >{{data.name}}</option>
				      </select>
				    </div>
				</div>
				<div class="ant_row">
					<div class="c_text">
						<label class="c_title">商户地址</label>
					</div>
					<div class="c_input">
						<input id="shopAddress" class="ant_input" type="text" name="shopName" placeholder="请输入商户详细地址">
					</div>
				</div>
				<div class="ant_row">
					<div class="c_text">
						<label class="c_title">商户电话</label>
					</div>
					<div class="c_input">
						<input id="shopTelphone" class="ant_input" type="text" name="shopName" placeholder="请输入电话号码">
					</div>
				</div>
				<div class="ant_row">
					<div class="c_text">
						<label class="c_title">营业时间</label>
					</div>
					<div class="c_input">
						<input id="officeHours" class="ant_input" type="text" name="shopName" placeholder="请输入营业时间">
					</div>
				</div>
				<div class="ant_row">
					<div class="c_text">
						<label class="c_title">商户简介</label>
					</div>
					<div class="c_input">
						<!-- <input class="ant_input" type="text" name="shopName" placeholder="请输入商户名称"> -->
						<textarea id="shopIntroduce" class="tar_plain" cols rows="5" placeholder="简单介绍商户" name="introduce"></textarea>
					</div>
				</div>
			</form>
			<div class="dpshop-add-divider"></div>
			<div class="foot">
				<input onclick="addShop()" class="add_input" type="button" name="button" value="添加商户">
			</div>
		</div>
	</div>


	<div class="footer-container">
		<div class="channel-footer">
			<p class="links">
				<a href="#" class="links_p">关于当地小食&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</a>
				<a href="" class="links_p">诚信公约&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</a>				
				<a href="" class="links_p">网站帮助&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</a>
				<a href="" class="links_p">网站地图&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</a>
				<a href="" class="links_p">最新咨询&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</a>
				<a href="" class="links_p">人才招聘&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</a>
				<a href="" class="links_p">联系我们&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</a>
				<div class="clear"></div>
			</p>
			<p class="rights">
				<span>
					©2017-2018 ddxs.com, All Rights Reserved.
				</span>
			</p>
		</div>
	</div>	
</body>
<script>
	
	is_shopping();
	type(3,"#cuisine");
	type(1,"#air");
	type(2,"#area");
	function addShop(){
		$.ajax({
			type:"post",
			url:url+"/shop/addShop",
			dataType:"json",
			async:true,
			data:{
				token:localStorage["token"],
				shop_name:$("#shopName").val(),
				shop_telphone:$("#shopTelphone").val(),
				office_hours:$("#officeHours").val(),
				content:$("#shopIntroduce").val(),
				shop_address:$("#shopAddress").val(),
				area_id:$("#area_op").attr("value"),
			},success:function(data){
				console.log(data);
				save(data.data.shopId);
				shopping();
				window.location.href="MyShopping.html";
			}
		});
	}
	function save(shopId){
			var obj1 = document.getElementsByName("caixi");
	    	var check_val_1 = "";
	    	for(k in obj1){
	        	if(obj1[k].checked)
	            	check_val_1=check_val_1 + (obj1[k].value) + ",";
	    	} 
	    	//alert(check_val_1)
	    	var obj2 = document.getElementsByName("fenwei");
	    	var check_val_2 = "";
	    	for(k in obj2){
	        	if(obj2[k].checked)
	            	check_val_2 = check_val_2 +(obj2[k].value)+",";
	    	}	
	    	$.ajax({
	    		type:"post",
	    		url:url+"/airInfo/addAirInfo",
	    		dataType:"json",
	    		async:true,
	    		data:{
	    			shop_id:shopId,
	    			air_id:check_val_2,
	    		},success:function(data){
	    			console.log(data);
	    		}
	    	});
	    	$.ajax({
	    		type:"post",
	    		url:url+"/cuisine/addCuisine",
	    		dataType:"json",
	    		async:true,
	    		data:{
	    			shop_id:shopId,
	    			cuisine_id:check_val_1,
	    		},success:function(data){
	    			console.log(data);
	    		}
	    	});
	}
	function shopping(){
		$.ajax({
			type:"post",
			url:url+"/user/shopping",
			dataType:"json",
			async:true,
			data:{
				token:localStorage["token"],
				is_shop:"1",
			},success:function(data){
				console.log(data);
				localStorage.setItem("isShopping",data.data.isShopping);
			}
		});
	}

		


</script>
</html>